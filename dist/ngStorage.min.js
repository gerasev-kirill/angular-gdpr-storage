/*! ngstorage 0.3.7 | Copyright (c) 2018 Gias Kay Lee | MIT License */
"use strict";var GdprException,STORAGE_PREFIX,generateStorageFactory,getStorageKey,ngGdprStorage,ngLocalStorage,ngSessionStorage,rmNgGdprStorageWatch,rmNgLocalStorageWatch,rmNgSessionStorageWatch;STORAGE_PREFIX="ngStorage-",GdprException=function(a){return this.name="GdprException",this.message=a||"",this},GdprException.prototype=new Error,GdprException.prototype.constructor=GdprException,getStorageKey=function(a){return a.slice(STORAGE_PREFIX.length)},generateStorageFactory=function(a,b,c,d,e,f,g){var h,i,j,k;return i=null,j=null,g=g||{},k=function(a){var d,e,g,h,i;"gdprStorage"===a&&(a=f),i=void 0;try{i=b[a]}catch(e){d=e,i=!1}if(i&&"localStorage"===a){h="__"+Math.round(1e7*Math.random());try{i.setItem(h,h),i.removeItem(h)}catch(g){d=g,i=!1}}return i?i:(c.warn("This browser does not support Web Storage!"),{setItem:angular.noop,getItem:angular.noop,removeItem:angular.noop,key:angular.noop})},h={$default:function(a){var b,c;for(b in a)c=a[b],angular.isDefined(h[b])||(h[b]=c);return h.$sync(),h},$reset:function(a){var b,c;c=k(e);for(b in h)"$"!==b[0]&&(delete h[b],c.removeItem(STORAGE_PREFIX+b));return h.$default(a)},$sync:function(){var a,b,c;c=k(e);for(b in c)b&&0===b.indexOf(STORAGE_PREFIX)&&(a=getStorageKey(b),("gdprStorage"!==e||g[a])&&("gdprStorage"===e&&"gdprPermission"===a?h.$setPermission(angular.fromJson(c.getItem(b))):h[a]=angular.fromJson(c.getItem(b))))},$apply:function(){var a,b,c,d;if(i=null,b=void 0,d=k(e),!angular.equals(h,j)){b=angular.copy(j);for(a in h)if(c=h[a],angular.isDefined(c)&&"$"!==a[0]){if("gdprStorage"===e&&!g[a])throw new GdprException("You can't assign key '"+a+"' for $gdprStorage! Please register key '"+a+"' inside config block with this: $gdprStorageProvider.registerKey('"+a+"')");d.setItem(STORAGE_PREFIX+a,angular.toJson(c)),delete b[a]}for(a in b)d.removeItem(STORAGE_PREFIX+a);j=angular.copy(h)}}},"gdprStorage"===e&&(h.gdprPermission={app:!1},h.$getAllowedKeys=function(){return angular.copy(g)},h.$setPermission=function(a){var b,c,d,e,g,i;if(a=a||{},a.app=!!a.app,g=a.app?"localStorage":"sessionStorage",h.gdprPermission=a,e=k(f),d=k(g),d.setItem(STORAGE_PREFIX+"gdprPermission",angular.toJson(a)),g!==f){if(e)for(c in e)i=e[c],c&&0===c.indexOf(STORAGE_PREFIX)&&(c!==STORAGE_PREFIX+"gdprPermission"&&d.setItem(c,i),e.removeItem(c));for(c in d)c&&0===c.indexOf(STORAGE_PREFIX)&&(b=getStorageKey(c),h[b]=angular.fromJson(d.getItem(c)));f=g}}),h.$sync(),j=angular.copy(h),b.addEventListener("storage",function(b){var c;b&&b.key&&b.storageArea===k(e)&&(c=getStorageKey(b.key),b.key===STORAGE_PREFIX+c&&(b.newValue?h[c]=angular.fromJson(b.newValue):delete h[c],j=angular.copy(h),a.$$phase||a.$apply()))}),b.addEventListener("beforeunload",function(a){h.$apply()},!1),h},ngLocalStorage=null,ngSessionStorage=null,ngGdprStorage=null,rmNgLocalStorageWatch=null,rmNgSessionStorageWatch=null,rmNgGdprStorageWatch=null,angular.module("ngStorage",[]).provider("ngStorage",function(){return this.setPrefix=function(a){STORAGE_PREFIX=a||""},this.$get=function(){return{getPrefix:function(){return STORAGE_PREFIX}}},this}).service("$localStorage",["$rootScope","$window","$log","$timeout",function(a,b,c,d){var e;return e=null,ngLocalStorage?ngLocalStorage.$sync():ngLocalStorage=generateStorageFactory(a,b,c,d,"localStorage"),rmNgLocalStorageWatch&&rmNgLocalStorageWatch(),rmNgLocalStorageWatch=a.$watch(function(){return e||(e=d(function(){return ngLocalStorage.$apply()},100,!1)),e}),ngLocalStorage}]).service("$sessionStorage",["$rootScope","$window","$log","$timeout",function(a,b,c,d){var e;return e=null,ngSessionStorage?ngSessionStorage.$sync():ngSessionStorage=generateStorageFactory(a,b,c,d,"sessionStorage"),rmNgSessionStorageWatch&&rmNgSessionStorageWatch(),rmNgSessionStorageWatch=a.$watch(function(){return e||(e=d(function(){return ngSessionStorage.$apply()},100,!1)),e}),ngSessionStorage}]).provider("$gdprStorage",function(){var a;return a={},this.registerKey=function(b,c){c=c||{},a[b]=c},this.$get=["$rootScope","$window","$log","$timeout",function(b,c,d,e){var f,g,h,i,j;if(f=null,ngGdprStorage)ngGdprStorage.$sync();else{ngSessionStorage?ngSessionStorage.$sync():ngSessionStorage=generateStorageFactory(b,c,d,e,"sessionStorage"),ngLocalStorage?ngLocalStorage.$sync():ngLocalStorage=generateStorageFactory(b,c,d,e,"localStorage"),h={app:!1},angular.isObject(ngLocalStorage.gdprPermission)?h=ngLocalStorage.gdprPermission:angular.isObject(ngSessionStorage.gdprPermission)&&(h=ngSessionStorage.gdprPermission);for(g in a)j="",ngSessionStorage[g]&&(j=ngSessionStorage[g]),ngLocalStorage&&ngLocalStorage[g]&&(j=ngLocalStorage[g]),""!==j&&(h.app?ngLocalStorage[g]=j:ngSessionStorage[g]=j);h.app?(ngLocalStorage.$apply(),i="localStorage"):(ngSessionStorage.$apply(),i="sessionStorage"),ngGdprStorage=generateStorageFactory(b,c,d,e,"gdprStorage",i,a),ngGdprStorage.$setPermission(h)}return rmNgGdprStorageWatch&&rmNgGdprStorageWatch(),rmNgGdprStorageWatch=b.$watch(function(){return f||(f=e(function(){return ngGdprStorage.$apply()},100,!1)),f}),ngGdprStorage}],this}).config(["$gdprStorageProvider",function(a){return a.registerKey("gdprPermission",{description:"GDPR permission data for site"})}]);